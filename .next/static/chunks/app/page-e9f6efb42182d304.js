(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7071:function(e,a,n){Promise.resolve().then(n.bind(n,6911))},6911:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return s}});var o=n(3827),t=n(4090);let l=(0,n(1051).eI)("https://mxwliocmvvthuylwvooq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im14d2xpb2NtdnZ0aHV5bHd2b29xIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ4Njc2NTcsImV4cCI6MjA2MDQ0MzY1N30.2SmRcPGQ1LgYFi3c6NlQufSE0s_g86Y3-2pLx34jyQQ");function s(){let[e,a]=(0,t.useState)({nama_pemohon:"",jenis_pohon:"",jumlah_pohon:0,lokasi:"",foto:null,tanggal_survey:"",keterangan:""}),[n,s]=(0,t.useState)([]),[r,i]=(0,t.useState)(!1);async function u(){let{data:e}=await l.from("pendataan_pohon").select("*").order("created_at",{ascending:!1});e&&s(e)}async function m(n){n.preventDefault(),i(!0);let o="";if(e.foto){let a=e.foto.name.split(".").pop(),n="".concat(Date.now(),".").concat(a),{data:t,error:s}=await l.storage.from("foto-pohon").upload(n,e.foto);if(s){alert("Upload foto gagal."),i(!1);return}let{data:r}=l.storage.from("foto-pohon").getPublicUrl(n);o=r.publicUrl}let{error:t}=await l.from("pendataan_pohon").insert({nama_pemohon:e.nama_pemohon,jenis_pohon:e.jenis_pohon,jumlah_pohon:e.jumlah_pohon,lokasi:e.lokasi,foto_url:o,tanggal_survey:e.tanggal_survey,keterangan:e.keterangan});t||(alert("Data berhasil disimpan!"),a({nama_pemohon:"",jenis_pohon:"",jumlah_pohon:0,lokasi:"",foto:null,tanggal_survey:"",keterangan:""}),u()),i(!1)}function c(e){let{name:n,value:o}=e.target;a(e=>({...e,[n]:o}))}return(0,t.useEffect)(()=>{u()},[]),(0,o.jsxs)("main",{className:"max-w-xl mx-auto p-4",children:[(0,o.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"SI ABANG - Input Data Pohon"}),(0,o.jsxs)("form",{onSubmit:m,className:"space-y-3",children:[(0,o.jsx)("input",{name:"nama_pemohon",placeholder:"Nama Pemohon",className:"w-full p-2 border",onChange:c,value:e.nama_pemohon,required:!0}),(0,o.jsx)("input",{name:"jenis_pohon",placeholder:"Jenis Pohon",className:"w-full p-2 border",onChange:c,value:e.jenis_pohon,required:!0}),(0,o.jsx)("input",{name:"jumlah_pohon",type:"number",min:"1",placeholder:"Jumlah Pohon",className:"w-full p-2 border",onChange:c,value:e.jumlah_pohon,required:!0}),(0,o.jsx)("input",{name:"lokasi",placeholder:"Lokasi (GPS)",className:"w-full p-2 border",onChange:c,value:e.lokasi,required:!0}),(0,o.jsx)("button",{type:"button",onClick:function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{let{latitude:n,longitude:o}=e.coords;a(e=>({...e,lokasi:"".concat(n,",").concat(o)}))})},className:"text-blue-600 underline text-sm",children:"Deteksi Lokasi Otomatis"}),(0,o.jsx)("input",{name:"tanggal_survey",type:"date",className:"w-full p-2 border",onChange:c,value:e.tanggal_survey,required:!0}),(0,o.jsx)("textarea",{name:"keterangan",placeholder:"Keterangan",className:"w-full p-2 border",onChange:c,value:e.keterangan}),(0,o.jsx)("input",{type:"file",accept:"image/*",onChange:n=>{var o;return a({...e,foto:(null===(o=n.target.files)||void 0===o?void 0:o[0])||null})}}),(0,o.jsx)("button",{disabled:r,className:"bg-green-600 text-white px-4 py-2 rounded",children:r?"Menyimpan...":"Simpan Data"})]}),(0,o.jsx)("h2",{className:"text-xl font-semibold mt-8 mb-2",children:"Data Tersimpan"}),(0,o.jsx)("ul",{className:"space-y-2",children:n.map(e=>(0,o.jsxs)("li",{className:"p-3 border rounded",children:[(0,o.jsx)("strong",{children:e.nama_pemohon})," - ",e.jenis_pohon," (",e.jumlah_pohon,")",(0,o.jsx)("br",{}),(0,o.jsx)("span",{className:"text-sm text-gray-500",children:e.tanggal_survey}),(0,o.jsx)("br",{}),e.foto_url&&(0,o.jsx)("img",{src:e.foto_url,alt:"foto pohon",className:"w-32 mt-1"})]},e.id))})]})}}},function(e){e.O(0,[51,971,69,744],function(){return e(e.s=7071)}),_N_E=e.O()}]);